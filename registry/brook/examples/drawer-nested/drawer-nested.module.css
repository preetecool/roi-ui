.popup {
  --bleed: 3rem;
  --peek: 1rem;
  --stack-progress: clamp(0, var(--drawer-swipe-progress), 1);
  --stack-step: 0.05;
  --stack-peek-offset: max(
    0px,
    calc((var(--nested-drawers) - var(--stack-progress)) * var(--peek))
  );
  --stack-scale-base: max(0, calc(1 - (var(--nested-drawers) * var(--stack-step))));
  --stack-scale: calc(var(--stack-scale-base) + (var(--stack-step) * var(--stack-progress)));
  --stack-shrink: calc(1 - var(--stack-scale));
  --stack-height: max(
    0px,
    calc(var(--drawer-frontmost-height, var(--drawer-height)) - var(--bleed))
  );
  --translate-y: calc(
    var(--drawer-swipe-movement-y) - var(--stack-peek-offset) -
      (var(--stack-shrink) * var(--stack-height))
  );

  position: relative;
  height: var(--drawer-height, auto);
  box-shadow:
    0 2px 10px rgb(0 0 0 / 0.1),
    0 0 0 1px oklch(from var(--border) l c h / 0.5);
  transform-origin: 50% calc(100% - var(--bleed));
  transition:
    transform 450ms cubic-bezier(0.32, 0.72, 0, 1),
    height 450ms cubic-bezier(0.32, 0.72, 0, 1),
    box-shadow 450ms cubic-bezier(0.32, 0.72, 0, 1);
  transform: translateY(var(--translate-y)) scale(var(--stack-scale));

  &[data-swiping],
  &[data-nested-drawer-swiping] {
    transition-duration: 0ms;
  }

  &::after {
    content: "";
    inset: 0;
    position: absolute;
    border-radius: inherit;
    background-color: transparent;
    pointer-events: none;
    transition: background-color 450ms cubic-bezier(0.32, 0.72, 0, 1);
  }

  &[data-nested-drawer-open] {
    height: calc(var(--stack-height) + var(--bleed));
    overflow: hidden;

    &::after {
      background-color: rgb(0 0 0 / 0.05);
    }
  }

  &[data-starting-style],
  &[data-ending-style] {
    transform: translateY(calc(100% - var(--bleed)));
  }

  &[data-ending-style] {
    box-shadow:
      0 2px 10px rgb(0 0 0 / 0),
      0 0 0 1px oklch(from var(--border) l c h / 0);
    transition-duration: calc(var(--drawer-swipe-strength) * 400ms);
  }
}

.content {
  transition: opacity 300ms cubic-bezier(0.45, 1.005, 0, 1.005);

  [data-nested-drawer-open] & {
    opacity: 0;
  }

  [data-nested-drawer-open][data-nested-drawer-swiping] & {
    opacity: 1;
  }
}

.handle {
  transition: opacity 0.2s;

  [data-nested-drawer-open] & {
    opacity: 0;
  }

  [data-nested-drawer-open][data-nested-drawer-swiping] & {
    opacity: 1;
  }
}

.title {
  text-align: center;
}

.description {
  text-align: center;
}

.actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 1rem;
}

.actionsLeft {
  margin-right: auto;
}

.linkButton {
  padding-left: 0;
}

.list {
  margin: 0 0 1.5rem;
  padding-left: 1.25rem;
  color: var(--muted-foreground);
}

.field {
  display: grid;
  gap: 0.375rem;
  margin-bottom: 1rem;
}

.label {
  font-size: 0.875rem;
  line-height: 1.25rem;
  font-weight: 500;
  color: var(--muted-foreground);
}

.input,
.textarea {
  box-sizing: border-box;
  width: 100%;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background-color: var(--background);
  color: var(--foreground);
  padding: 0.5rem 0.625rem;
  font: inherit;
  font-size: 0.875rem;
}

.textarea {
  resize: vertical;
}

.input:focus-visible,
.textarea:focus-visible {
  outline: 2px solid var(--ring);
  outline-offset: -1px;
}
